CREATE SEQUENCE GENERATOR_CLIENTE_ID;

CREATE TABLE CLIENTE (
ID INTEGER NOT NULL PRIMARY KEY,
NOME VARCHAR(120) NOT NULL,
DOCUMENTO VARCHAR(20),
EMAIL VARCHAR(120),
TELEFONE VARCHAR(30),
DATACADASTRO TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

CREATE TRIGGER CLIENTE_INSERIR FOR CLIENTE 
ACTIVE BEFORE INSERT POSITION 0 AS 
BEGIN 
  IF (NEW.ID IS NULL) THEN 
    NEW.ID = NEXT VALUE FOR GENERATOR_CLIENTE_ID; 
END;

CREATE SEQUENCE GENERATOR_ORDEM_SERVICO_ID;

CREATE TABLE ORDEM_SERVICO ( 
ID INTEGER NOT NULL PRIMARY KEY, 
CLIENTE_ID INTEGER, 
DATA_ABERTURA DATE NOT NULL, 
DATA_PREVISTA DATE, 
DATA_FECHAMENTO DATE, 
STATUS VARCHAR(15) NOT NULL, 
DESCRICAO_PROBLEMA VARCHAR(500), 
VALOR_TOTAL NUMERIC(15,2) DEFAULT 0, 
CONSTRAINT FK_OS_CLIENTE FOREIGN KEY (CLIENTE_ID) REFERENCES CLIENTE(ID) 
);


CREATE TRIGGER ORDEM_SERVICO_INSERIR FOR ORDEM_SERVICO 
ACTIVE BEFORE INSERT POSITION 0 AS 
BEGIN 
  IF (NEW.ID IS NULL) THEN 
    NEW.ID = NEXT VALUE FOR GENERATOR_ORDEM_SERVICO_ID; 
END;

CREATE INDEX IDX_OS_STATUS ON ORDEM_SERVICO (STATUS);

CREATE INDEX IDX_OS_CLIENTE ON ORDEM_SERVICO (CLIENTE_ID);

CREATE INDEX IDX_OS_DATA_ABERTURA ON ORDEM_SERVICO (DATA_ABERTURA);